SOCKET(7)                 Manuel du programmeur Linux                SOCKET(7)

[1mNOM[0m
       socket - Interface Linux aux sockets

[1mSYNOPSIS[0m
       [1m#include <sys/socket.h>[0m

       [4msockfd[24m [1m= socket(int [4m[22mfamille_socket[24m[1m, int [4m[22mtype_socket[24m[1m, int [4m[22mprotocole[24m[1m);[0m

[1mDESCRIPTION[0m
       Cette page de manuel documente l'interface utilisateur de l'implÃ©mentaâ€
       tion Linux des sockets rÃ©seau. Les sockets compatibles BSD reprÃ©sentent
       l'interface  uniforme  entre  le  processus utilisateur et les piles de
       protocoles rÃ©seau dans  le  noyau.  Les  modules  des  protocoles  sont
       regroupÃ©s  en  [4mfamilles[24m  [4mde[24m  [4mprotocoles[24m  tels  que  [1mAF_INET[22m,  [1mAF_IPX [22met
       [1mAF_PACKET[22m, et en [4mtypes[24m [4mde[24m  [4msockets[24m  comme  [1mSOCK_STREAM  [22mou  [1mSOCK_DGRAM[22m.
       Consultez  [1msocket[22m(2)  pour  plus d'informations sur les familles et les
       types de sockets.

   [1mFonctions du niveau socket[0m
       Ces fonctions servent au processus utilisateur pour envoyer ou recevoir
       des  paquets  et  pour  faire d'autres opÃ©rations sur les sockets. Pour
       plus de dÃ©tails, consultez leurs pages de manuel respectives.

       [1msocket[22m(2) crÃ©e une socket, [1mconnect[22m(2) connecte une socket Ã  une adresse
       de  socket  distante,  la  fonction  [1mbind[22m(2)  attache  une socket Ã  une
       adresse  locale,  [1mlisten[22m(2)  indique  Ã   la  socket  que  de  nouvelles
       connexions  doivent  Ãªtre  acceptÃ©es, et [1maccept[22m(2) fournit une nouvelle
       socket avec la nouvelle connexion entrante. [1msocketpair[22m(2) renvoie  deux
       sockets   anonymes   connectÃ©es  (seulement  implÃ©mentÃ©  pour  quelques
       familles locales comme [1mAF_UNIX[22m).

       [1msend[22m(2), [1msendto[22m(2), et [1msendmsg[22m(2) envoient des donnÃ©es sur une  socket,
       et  [1mrecv[22m(2),  [1mrecvfrom[22m(2)  et [1mrecvmsg[22m(2) reÃ§oivent les donnÃ©es envoyÃ©es
       par une socket. [1mpoll[22m(2) et [1mselect[22m(2) attendent que des donnÃ©es arrivent
       ou  que l'Ã©mission soit possible. De plus, les opÃ©rations d'entrÃ©e-sorâ€
       tie  standard  comme  [1mwrite[22m(2),  [1mwritev[22m(2),  [1msendfile[22m(2),  [1mread[22m(2)   et
       [1mreadv[22m(2)  peuvent Ãªtre utilisÃ©es pour la lecture et l'Ã©criture des donâ€
       nÃ©es.

       [1mgetsockname[22m(2) renvoie l'adresse de la socket locale et  [1mgetpeername[22m(2)
       renvoie l'adresse de la socket distante. [1mgetsockopt[22m(2) et [1msetsockopt[22m(2)
       servent Ã  dÃ©finir et obtenir les options de la couche socket ou  protoâ€
       cole. [1mioctl[22m(2) peut Ãªtre utilisÃ© pour lire et Ã©crire d'autres options.

       [1mclose[22m(2)  sert  Ã   fermer  une socket. [1mshutdown[22m(2) ferme une partie des
       connexions d'une socket multiple.

       La recherche ou l'utilisation de [1mpread[22m(2) et [1mpwrite[22m(2) avec un dÃ©calage
       non nul n'est pas possible sur les sockets.

       Des opÃ©rations d'entrÃ©e-sortie non bloquantes sur les sockets sont posâ€
       sibles en dÃ©finissant l'attribut [1mO_NONBLOCK [22mdu descripteur de la socket
       avec  [1mfcntl[22m(2). Toutes les opÃ©rations qui devraient normalement bloquer
       se terminent alors avec l'erreur [1mEAGAIN [22m(l'opÃ©ration devra Ãªtre  retenâ€
       tÃ©e ultÃ©rieurement). [1mconnect[22m(2) renverra l'erreur [1mEINPROGRESS[22m. L'utiliâ€
       sateur peut alors attendre divers Ã©vÃ©nements avec [1mpoll[22m(2) ou [1mselect[22m(2).

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                        Ã‰vÃ©nements E/S                         â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Ã‰vÃ©nement    â”‚ Appel   â”‚ Circonstance                          â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Lecture      â”‚ POLLIN  â”‚ ArrivÃ©e de nouvelles donnÃ©es          â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Lecture      â”‚ POLLIN  â”‚ Configuration d'une connexion achevÃ©e â”‚
       â”‚             â”‚         â”‚ (pour     les    sockets    orientÃ©es â”‚
       â”‚             â”‚         â”‚ connexion)                            â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Lecture      â”‚ POLLHUP â”‚ Demande de  dÃ©connexion  initiÃ©e  par â”‚
       â”‚             â”‚         â”‚ l'autre extrÃ©mitÃ©                     â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Lecture      â”‚ POLLHUP â”‚ Connexion  rompue (seulement pour les â”‚
       â”‚             â”‚         â”‚ protocoles orientÃ©s  connexion)  Lors â”‚
       â”‚             â”‚         â”‚ de   l'Ã©criture  sur  la  socket,  le â”‚
       â”‚             â”‚         â”‚ signal [1mSIGPIPE [22mest aussi Ã©mis.        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Ã‰criture     â”‚ POLLOUT â”‚ La socket a assez de  place  dans  le â”‚
       â”‚             â”‚         â”‚ tampon d'Ã©mission pour Ã©crire de nouâ€ â”‚
       â”‚             â”‚         â”‚ velles donnÃ©es.                       â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Lect./Ã‰crit. â”‚ POLLIN| â”‚ Un appel  sortant  Ã   [1mconnect[22m(2)  est â”‚
       â”‚             â”‚ POLLOUT â”‚ terminÃ©.                              â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Lect./Ã‰crit. â”‚ POLLERR â”‚ Une erreur asynchrone s'est produite. â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Lect./Ã‰crit. â”‚ POLLHUP â”‚ Le  correspondant  a  clos un sens de â”‚
       â”‚             â”‚         â”‚ communication.                        â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚Exception    â”‚ POLLPRI â”‚ ArrivÃ©e de donnÃ©es  urgentes.  [1mSIGURG [22mâ”‚
       â”‚             â”‚         â”‚ est alors envoyÃ©.                     â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       Une alternative Ã  [1mpoll[22m(2) et [1mselect[22m(2) est de laisser le noyau informer
       l'application des Ã©vÃ©nements par  l'intermÃ©diaire  d'un  signal  [1mSIGIO[22m.
       Pour  cela,  l'attribut  [1mO_ASYNC [22mdoit Ãªtre dÃ©fini sur un descripteur de
       fichier de la socket via [1mfcntl[22m(2) et un gestionnaire de signal  valable
       pour   [1mSIGIO  [22mdoit  Ãªtre  installÃ©  avec  [1msigaction[22m(2).  Consultez  les
       remarques sur les [4mSignaux[24m ci-dessous.

   [1mStructures d'adresse de socket[0m
       Chaque domaine de socket a son  propre  format  pour  les  adresses  de
       socket,  avec une structure d'adresse propre. Chacune de ces structures
       commence  avec  un  champ  entier   Â« family Â»   (famille),   de   type
       [4msa_family_t[24m,  qui  indique  le type de structure d'adresse. Cela permet
       aux appels systÃ¨me gÃ©nÃ©riques Ã   tous  les  domaines  de  sockets  (par
       exemple [1mconnect[22m(2), [1mbind[22m(2), [1maccept[22m(2), [1mgetsockname[22m(2), [1mgetpeername[22m(2))
       de dÃ©terminer le domaine d'une adresse de socket donnÃ©e.

       Le type [4mstruct[24m [4msockaddr[24m est dÃ©fini afin  de  pouvoir  passer  n'importe
       quel  type d'adresse de socket aux interface dans l'API des sockets. Le
       but de  ce  type  est  purement  d'autoriser  la  conversion  de  types
       d'adresse  de  socket  propres Ã  un domaine vers le type Â« gÃ©nÃ©rique Â»,
       afin d'Ã©viter les avertissements du compilateur au sujet de la non corâ€
       respondance dans les appels de l'API des sockets.

       De   plus,  l'API  des  sockets  fournit  le  type  de  donnÃ©es  [4mstruct[0m
       [4msockaddr_storage[24m. Ce  type  est  fait  pour  contenir  toute  structure
       d'adresse  de socket spÃ©cifique Ã  un domaine. Il est suffisamment grand
       et est alignÃ© correctement (en particulier, il  est  assez  grand  pour
       contenir  des  adresses  de  socket  IPv6). Cette structure contient le
       champ suivant, qui peut Ãªtre utilisÃ© pour identifier le type  d'adresse
       socket effectivement stockÃ©e dans la structure :

               sa_family_t ss_family;

       La structure [4msockaddr_storage[24m est utile dans les programmes qui doivent
       prendre en charge les adresses de  socket  de  maniÃ¨re  gÃ©nÃ©rique  (par
       exemple  les  programmes  qui  doivent  gÃ©rer Ã  la fois des adresses de
       socket IPv4 et IPv6).

   [1mOptions de sockets[0m
       Les options prÃ©sentÃ©es ci-dessous peuvent Ãªtre  dÃ©finies  en  utilisant
       [1msetsockopt[22m(2) et lues avec [1mgetsockopt[22m(2) avec le niveau de socket posiâ€
       tionnÃ© Ã  [1mSOL_SOCKET[22m, et  ce  pour  toutes  les  sockets.  Sauf  mention
       contraire, [4moptval[24m est un pointeur vers un [4mint[24m.

       [1mSO_ACCEPTCONN[0m
              Renvoie  une  valeur indiquant si la socket a Ã©tÃ© dÃ©clarÃ©e comme
              acceptant les connexions Ã   l'aide  de  [1mlisten[22m(2).  La  valeur 0
              indique  que  la socket n'est pas en attente de connexions et la
              valeur 1 indique que la socket  accepte  les  connexions.  Cette
              option de socket peut Ãªtre seulement lue, et pas modifiÃ©e.

       [1mSO_BINDTODEVICE[0m
              Attache  cette socket Ã  un pÃ©riphÃ©rique donnÃ©, tel que Â« eth0 Â»,
              comme indiquÃ© dans le nom d'interface transmis. Si  le  nom  est
              une  chaÃ®ne  vide  ou  si  la longueur de l'option est nulle, la
              socket est dÃ©tachÃ©e du pÃ©riphÃ©rique. L'option transmise est  une
              chaÃ®ne  de  longueur  variable  terminÃ©e  par  un caractÃ¨re nul,
              contenant le nom de  l'interface,  la  longueur  maximale  Ã©tant
              [1mIFNAMSIZ[22m.  Si une socket est attachÃ©e Ã  une interface, seuls les
              paquets reÃ§us de cette interface particuliÃ¨re sont  traitÃ©s  par
              la  socket.  Cela  ne  fonctionne  que  pour  certains  types de
              sockets, en particulier les sockets [1mAF_INET[22m. Ce n'est  pas  gÃ©rÃ©
              pour les sockets paquet (utilisez pour cela [1mbind[22m(2)).

              Avant Linux 3.8, cette option de socket pouvait Ãªtre configurÃ©e,
              sans pouvoir Ãªtre lue par [1mgetsockopt[22m(2). Depuis Linux 3.8,  elle
              est lisible. Le paramÃ¨tre [4moptlen[24m doit contenir la taille du tamâ€
              pon destinÃ© Ã  recevoir le nom  du  pÃ©riphÃ©rique,  prÃ©fÃ©rablement
              [1mIFNAMSZ[22m.  La  vÃ©ritable longueur du nom du pÃ©riphÃ©rique est renâ€
              voyÃ©e dans le paramÃ¨tre [4moptlen[24m.

       [1mSO_BROADCAST[0m
              DÃ©finir ou lire l'attribut de diffusion. Une  fois  activÃ©,  les
              sockets  de  datagrammes sont autorisÃ©es Ã  envoyer des paquets Ã 
              une adresse de diffusion. Cette option n'a aucun effet  sur  les
              sockets orientÃ©es flux.

       [1mSO_BSDCOMPAT[0m
              Active  la compatibilitÃ© BSD bogue-Ã -bogue. Cela est utilisÃ© par
              le module du protocole UDP de Linux 2.0 et 2.2. Si cette  compaâ€
              tibilitÃ©  est  activÃ©e,  les erreurs ICMP reÃ§ues pour une socket
              UDP ne seront pas transmises au programme utilisateur. Dans  les
              versions  rÃ©centes  du  noyau,  la gestion de cette option a Ã©tÃ©
              abandonnÃ©e progressivement : Linux 2.4 l'ignore  silencieusement
              et  Linux 2.6 gÃ©nÃ¨re une alerte noyau (printk()) si le programme
              utilise cette option. Linux 2.0 activait Ã©galement  les  options
              de  compatibilitÃ©  BSD bogue-Ã -bogue (modification alÃ©atoire des
              en-tÃªtes, non prise en compte de l'attribut de  diffusion)  pour
              les  sockets  brutes ayant cette option, mais cela a Ã©tÃ© Ã©liminÃ©
              dans Linux 2.2.

       [1mSO_DEBUG[0m
              Active le dÃ©bogage de socket. Cela n'est autorisÃ© que  pour  les
              processus  avec  la  capacitÃ©  [1mCAP_NET_ADMIN  [22mou  un identifiant
              d'utilisateur effectif Ã©gal Ã  0.

       [1mSO_DOMAIN [22m(depuis Linux 2.6.32)
              RÃ©cupÃ¨re le domaine de socket en tant  qu'entier,  en  renvoyant
              une valeur telle que [1mAF_INET6[22m. Consultez [1msocket[22m(2)  pour plus de
              dÃ©tails. Cette option de socket peut Ãªtre seulement lue, et  pas
              modifiÃ©e.

       [1mSO_ERROR[0m
              Lit  et  efface l'erreur en cours sur la socket. Cette option de
              socket peut Ãªtre seulement lue,  et  pas  modifiÃ©e.  Demande  un
              entier.

       [1mSO_DONTROUTE[0m
              Ne  pas  Ã©mettre par l'intermÃ©diaire d'une passerelle, n'envoyer
              qu'aux hÃ´tes directement connectÃ©s.  Le  mÃªme  effet  peut  Ãªtre
              obtenu   avec  l'attribut  [1mMSG_DONTROUTE  [22mdurant  une  opÃ©ration
              [1msend[22m(2) sur la socket. Demande un attribut entier boolÃ©en.

       [1mSO_KEEPALIVE[0m
              Active l'Ã©mission de  messages  pÃ©riodiques  gardant  la  socket
              ouverte  pour les sockets orientÃ©es connexion. Demande un attriâ€
              but entier boolÃ©en.

       [1mSO_LINGER[0m
              DÃ©finit ou lit l'option [1mSO_LINGER[22m. Le paramÃ¨tre est  une  strucâ€
              ture [4mlinger[24m.

                  struct linger {
                      int l_onoff;    /* dÃ©finition de l'activitÃ© */
                      int l_linger;   /* durÃ©e d'attente en secondes */
                  };

              Lorsque  ce  paramÃ¨tre  est  actif, un appel Ã  [1mclose[22m(2) ou [1mshutâ€[0m
              [1mdown[22m(2) ne se terminera pas  avant  que  tous  les  messages  en
              attente  pour  la  socket  aient Ã©tÃ© correctement Ã©mis ou que le
              dÃ©lai d'attente soit Ã©coulÃ©. Sinon, l'appel se termine  immÃ©diaâ€
              tement et la fermeture est effectuÃ©e en arriÃ¨re-plan. Lorsque la
              socket est fermÃ©e au cours d'un [1mexit[22m(2), elle attend toujours en
              arriÃ¨re-plan.

       [1mSO_MARK [22m(depuis Linux 2.6.25)
              Positionner  la  marque  pour chaque paquet envoyÃ© au travers de
              cette socket (similaire Ã  la cible MARK de netfilter, mais  pour
              les  sockets). Le changement de marque peut Ãªtre utilisÃ© pour un
              routage par marques  sans  netfilter  ou  pour  le  filtrage  de
              paquets.   Utiliser   cette   option   nÃ©cessite   la   capacitÃ©
              [1mCAP_NET_ADMIN[22m.

       [1mSO_OOBINLINE[0m
              Si cette option est activÃ©e, les donnÃ©es hors bande sont placÃ©es
              directement  dans  le  flux  des donnÃ©es reÃ§ues. Sinon, elles ne
              sont transmises que si l'attribut [1mMSG_OOB [22mest dÃ©fini  durant  la
              rÃ©ception.

       [1mSO_PASSCRED[0m
              Autorise  ou  interdit  la  rÃ©ception  des  messages de contrÃ´le
              [1mSCM_CREDENTIALS[22m. Pour plus de dÃ©tails, consultez [1munix[22m(7).

       [1mSO_PEEK_OFF [22m(depuis Linux 3.4)
              Cette option, qui n'est Ã  ce jour garantie que pour les  sockets
              [1munix[22m(7),  dÃ©finit  la  valeur  de la Â« position de lecture Â» (ou
              Â« peek offset Â») pour  l'appel  systÃ¨me  [1mrecv[22m(2)  lorsqu'il  est
              invoquÃ© avec l'attribut [1mMSG_PEEK[22m.

              Lorsque  cette  option reÃ§oit une valeur nÃ©gative (elle est iniâ€
              tialisÃ©e Ã  -1 pour toute  nouvelle  socket),  elle  se  comporte
              classiquement :  [1mrecv[22m(2), avec l'attribut [1mMSG_PEEK[22m, lit les donâ€
              nÃ©es depuis le dÃ©but de la file.

              Lorsque l'option reÃ§oit une valeur supÃ©rieure ou Ã©gale  Ã   zÃ©ro,
              alors  la lecture suivante des donnÃ©es accumulÃ©es dans la socket
              est rÃ©alisÃ©e Ã  la position prÃ©cisÃ©e par la valeur  de  l'option.
              Dans  le  mÃªme temps, la Â« position de lecture Â» est incrÃ©mentÃ©e
              du nombre d'octets lus dans la file, de faÃ§on Ã  ce que  la  proâ€
              chaine lecture renvoie la donnÃ©e suivante dans la file.

              Si  des donnÃ©es sont retirÃ©es de la tÃªte de la file par la foncâ€
              tion [1mrecv[22m(2) (ou Ã©quivalent) sans l'attribut [1mMSG_PEEK[22m, alors  la
              Â« position  de lecture Â» est diminuÃ©e du nombre d'octets suppriâ€
              mÃ©s. Autrement dit, l'acquisition de donnÃ©es sans avoir  recours
              Ã   l'attribut [1mMSG_PEEK [22ma pour effet de modifier la Â« position de
              lecture Â», de sorte que la prochaine lecture renvoie les donnÃ©es
              qui  auraient Ã©tÃ© renvoyÃ©es si aucune donnÃ©e n'avait Ã©tÃ© suppriâ€
              mÃ©e.

              Pour les sockets de datagrammes, si la Â« position  de  lecture Â»
              pointe  Ã   l'intÃ©rieur  d'un paquet, alors les donnÃ©es renvoyÃ©es
              seront marquÃ©es de l'attribut [1mMSG_TRUNC[22m.

              L'exemple suivant illustre l'usage de [1mSO_PEEK_OFF[22m. Imaginons une
              socket de flux contenant les donnÃ©es suivantes dans sa file :

                  aabbccddeeff

              La sÃ©quence suivante d'appels Ã  [1mrecv[22m(2) aura l'effet dÃ©crit dans
              les commentaires :

                  int ov = 4;                  // affecte 4 Ã  la position de lecture
                  setsockopt(fd, SOL_SOCKET, SO_PEEK_OFF, &ov, sizeof(ov));

                  recv(fd, buf, 2, MSG_PEEK);  // Lit "cc"; l'indide de position prend la valeur 6
                  recv(fd, buf, 2, MSG_PEEK);  // Lit "dd"; l'indice de position prend la valeur 8
                  recv(fd, buf, 2, 0);         // Lit "aa"; l'indice de position prend la valeur 6
                  recv(fd, buf, 2, MSG_PEEK);  // Lit "ee"; l'indice position prend la valeur 8

       [1mSO_PEERCRED[0m
              Renvoie les donnÃ©es  d'authentification  du  processus  Ã©tranger
              connectÃ©  Ã   cette  socket.  Cela  n'est  possible  que pour les
              sockets de flux [1mAF_UNIX [22mconnectÃ©es  et  les  paires  de  sockets
              [1mAF_UNIX  [22mde  flux  et  de datagrammes crÃ©es avec [1msocketpair[22m(2) ;
              consultez  [1munix[22m(7).  Les  donnÃ©es  retournÃ©es  sont  celles  qui
              Ã©taient  effectives au moment de l'appel Ã  [1mconnect[22m(2) ou [1msocketâ€[0m
              [1mpair[22m(2). L'argument est une structure [4mucred[24m. Il faut dÃ©finir  la
              macro  de  test  de  fonctionnalitÃ©  [1m_GNU_SOURCE [22mpour activer la
              dÃ©finition de cette structure dans [4m<sys/socket.h>[24m. Cette  option
              de socket peut Ãªtre seulement lue, et pas modifiÃ©e.

       [1mSO_PRIORITY[0m
              DÃ©finir  la  prioritÃ©  dÃ©finie  par  le  protocole pour tous les
              paquets envoyÃ©s sur la socket. Linux utilise cette  valeur  pour
              trier  les  files  rÃ©seau : les paquets avec une prioritÃ© Ã©levÃ©e
              peuvent Ãªtre traitÃ©s d'abord, en  fonction  de  la  gestion  des
              files  sur  le  pÃ©riphÃ©rique.  Pour [1mip[22m(7), cela dÃ©finit aussi le
              champ IP Type-Of-Service (TOS) pour les paquets  sortants.  Ã‰taâ€
              blir  une  prioritÃ©  en  dehors  de l'intervalle allant de 0 Ã  6
              nÃ©cessite la capacitÃ© [1mCAP_NET_ADMIN[22m.

       [1mSO_PROTOCOL [22m(depuis Linux 2.6.32)
              RÃ©cupÃ¨re le protocole de socket en tant qu'entier, en  renvoyant
              une  valeur  telle  que  [1mIPPROTO_SCTP[22m. Consultez [1msocket[22m(2)  pour
              plus de dÃ©tails. Cette option de socket peut Ãªtre seulement lue,
              et pas modifiÃ©e.

       [1mSO_RCVBUF[0m
              DÃ©finit  ou lit la taille maximale en octets du tampon de rÃ©cepâ€
              tion. Le noyau double cette valeur  (pour  prÃ©voir  de  l'espace
              pour  les  opÃ©rations  de service) lorsque la valeur est dÃ©finie
              avec [1msetsockopt[22m(2), et cette valeur doublÃ©e  est  retournÃ©e  par
              [1mgetsockopt[22m(2).  La  valeur par dÃ©faut est dÃ©finie par le fichier
              [4m/proc/sys/net/core/rmem_default[24m et la valeur maximale  autorisÃ©e
              est  dÃ©finie  par  le  fichier  [4m/proc/sys/net/core/rmem_max[24m.  La
              valeur (doublÃ©e) minimale pour cette option est 256.

       [1mSO_RCVBUFFORCE [22m(depuis Linux 2.6.14)
              En utilisant cette option de  socket,  un  processus  privilÃ©giÃ©
              ([1mCAP_NET_ADMIN[22m)  peut exÃ©cuter la mÃªme tÃ¢che que [1mSO_RCVBUF[22m, mais
              la limite [4mrmem_max[24m peut Ãªtre remplacÃ©e.

       [1mSO_RCVLOWAT [22met [1mSO_SNDLOWAT[0m
              Indique le nombre minimal d'octets dans le tampon  pour  que  la
              couche  socket passe les donnÃ©es au protocole ([1mSO_SNDLOWAT[22m) ou Ã 
              l'utilisateur en rÃ©ception ([1mSO_RCVLOWAT[22m). Ces deux valeurs  sont
              initialisÃ©es  Ã   1.  [1mSO_SNDLOWAT  [22mn'est  pas  modifiable ([1msetsoâ€[0m
              [1mckopt[22m(2) Ã©choue  avec  l'erreur  [1mENOPROTOOPT[22m).  [1mSO_RCVLOWAT  [22mest
              modifiable   seulement  depuis  Linux 2.4.  Les  appels  systÃ¨me
              [1mselect[22m(2) et [1mpoll[22m(2) ne respectent pour le moment pas la dÃ©finiâ€
              tion de [1mSO_RCVLOWAT [22msur Linux, et marque la socket comme lisible
              mÃªme lorsqu'un unique octet de donnÃ©es est disponible.  La  lecâ€
              ture  suivante  depuis  la  socket  sera  bloquÃ©e jusqu'Ã  ce que
              [1mSO_RCVLOWAT [22moctets soient disponibles.

       [1mSO_RCVTIMEO [22met [1mSO_SNDTIMEO[0m
              Indiquer le dÃ©lai maximal d'Ã©mission ou de  rÃ©ception  avant  de
              signaler  une erreur. Le paramÃ¨tre est une structure [4mtimeval[24m. Si
              une fonction d'entrÃ©e ou de sortie bloque pendant cet intervalle
              de  temps  et  que  des  donnÃ©es  ont Ã©tÃ© envoyÃ©es ou reÃ§ues, la
              valeur de retour de cette fonction sera la quantitÃ©  de  donnÃ©es
              transmises ;  si  aucune donnÃ©e n'a Ã©tÃ© transmise et si le dÃ©lai
              d'attente est atteint, -1 est renvoyÃ© et [4merrno[24m est positionnÃ©e Ã 
              [1mEAGAIN  [22mou  [1mEWOULDBLOCK[22m, ou [1mEINPROGRESS [22m(pour [1mconnect[22m(2)), comme
              si la socket avait Ã©tÃ© dÃ©finie comme non bloquante. Si le  dÃ©lai
              d'attente  est dÃ©fini Ã  zÃ©ro (valeur par dÃ©faut), l'opÃ©ration ne
              sera jamais interrompue. Les dÃ©lais n'ont d'effet que  pour  les
              appels  systÃ¨me  faisant  des  E/S  sur des sockets (par exemple
              [1mread[22m(2),  [1mrecvmsg[22m(2),  [1msend[22m(2),  [1msendmsg[22m(2)) ;  ils  n'ont   pas
              d'effet pour [1mselect[22m(2), [1mpoll[22m(2), [1mepoll_wait[22m(2), etc.

       [1mSO_REUSEADDR[0m
              Indique que les rÃ¨gles utilisÃ©es pour la validation des adresses
              fournies dans un appel Ã  [1mbind[22m(2) doivent autoriser la rÃ©utilisaâ€
              tion des adresses locales. Pour les sockets [1mAF_INET[22m, cela signiâ€
              fie que la socket peut Ãªtre attachÃ©e Ã  n'importe quelle  adresse
              sauf  lorsqu'une  socket active en Ã©coute y est liÃ©e. Lorsque la
              socket en Ã©coute est attachÃ©e Ã  [1mINADDR_ANY [22mavec un  port  spÃ©ciâ€
              fique,  il n'est pas possible de s'attacher Ã  ce port quelle que
              soit  l'adresse  locale.  L'argument  est  un  attribut  boolÃ©en
              entier.

       [1mSO_RXQ_OVFL [22m(depuis Linux 2.6.33)
              Indique  qu'un  message  auxiliaire  (cmsg)  sous la forme d'une
              valeur non-signÃ©e et codÃ©e sur 32 bits doit Ãªtre jointe aux tamâ€
              pons  de  sockets  (skbs), indiquant le nombre de paquets perdus
              par la socket entre les deux derniers paquets reÃ§us.

       [1mSO_SNDBUF[0m
              DÃ©finit ou lit la taille maximale en octets  du  tampon  d'Ã©misâ€
              sion.  Le  noyau  double  cette valeur (pour prÃ©voir de l'espace
              pour les opÃ©rations de service) lorsque la  valeur  est  dÃ©finie
              avec  [1msetsockopt[22m(2),  et  cette valeur doublÃ©e est retournÃ©e par
              [1mgetsockopt[22m(2). La valeur par dÃ©faut est dÃ©finie par  le  fichier
              [4m/proc/sys/net/core/wmem_default[24m  et la valeur maximale autorisÃ©e
              est  dÃ©finie  par  le  fichier  [4m/proc/sys/net/core/wmem_max[24m.  La
              valeur (doublÃ©e) minimale pour cette option est 2048.

       [1mSO_SNDBUFFORCE [22m(depuis Linux 2.6.14)
              En  utilisant  cette  option  de socket, un processus privilÃ©giÃ©
              ([1mCAP_NET_ADMIN[22m) peut exÃ©cuter la mÃªme tÃ¢che que [1mSO_SNDBUF[22m,  mais
              la limite [4mwmem_max[24m peut Ãªtre remplacÃ©e.

       [1mSO_TIMESTAMP[0m
              Active  ou  dÃ©sactive  la  rÃ©ception  des  messages  de contrÃ´le
              [1mSO_TIMESTAMP[22m. Le message de  contrÃ´le  d'horodatage  est  envoyÃ©
              avec  le  niveau [1mSOL_SOCKET [22met le champ [4mcmsg_data[24m est une strucâ€
              ture [4mtimeval[24m indiquant la date de rÃ©ception  du  dernier  paquet
              fourni  Ã   l'utilisateur  dans cet appel. Consultez [1mcmsg[22m(3) pour
              plus de dÃ©tails sur les messages de contrÃ´le.

       [1mSO_TYPE[0m
              Lit le type de socket, sous forme d'entier (comme  [1mSOCK_STREAM[22m).
              Cette option de socket peut Ãªtre seulement lue, et pas modifiÃ©e.

       [1mSO_BUSY_POLL [22m(depuis Linux 3.11)
              DÃ©finit  la  durÃ©e  approximative,  en  milliseconde,  dâ€™attente
              active  de  rÃ©ception   bloquante   en   absence   de   donnÃ©es.
              [1mCAP_NET_ADMIN  [22mest  nÃ©cessaire  pour  augmenter cette valeur. La
              valeur par dÃ©faut pour cette option est contrÃ´lÃ©e par le fichier
              [4m/proc/sys/net/core/busy_read[24m.

              La valeur dans le fichier [4m/proc/sys/net/core/busy_poll[24m dÃ©termine
              la durÃ©e pendant laquelle [1mselect[22m(2) et [1mpoll[22m(2) seront en attente
              active  lors  dâ€™une  opÃ©ration sur des sockets avec [1mSO_BUSY_POLL[0m
              dÃ©fini et quâ€™aucun Ã©vÃ©nement Ã  signaler nâ€™est trouvÃ©.

              Dans les deux cas, lâ€™attente active ne sera rÃ©alisÃ©e que lorsque
              les  derniÃ¨res  donnÃ©es  reÃ§ues  par  la socket proviennent dâ€™un
              pÃ©riphÃ©rique rÃ©seau qui ne prend pas en charge cette option.

              Bien que lâ€™attente active peut amÃ©liorer la latence de  quelques
              applications, une attention particuliÃ¨re doit Ãªtre portÃ©es Ã  son
              utilisation puisque cela augmentera Ã  la fois  lâ€™utilisation  du
              processeur et la consommation puissance.

   [1mSignaux[0m
       Lors  de  l'Ã©criture sur une socket orientÃ©e connexion qui a Ã©tÃ© fermÃ©e
       (localement ou Ã  l'autre extrÃ©mitÃ©), le signal [1mSIGPIPE  [22mest  envoyÃ©  au
       processus  qui  Ã©crivait,  et  [1mEPIPE  [22mest  renvoyÃ©. Le signal n'est pas
       envoyÃ©  lorsque  l'appel  d'Ã©criture   indiquÃ©   contenait   l'attribut
       [1mMSG_NOSIGNAL[22m.

       Lorsque demandÃ© avec l'option [1mFIOSETOWN [22mde [1mfcntl[22m(2) ou l'option [1mSIOCSPâ€[0m
       [1mGRP [22mde  [1mioctl[22m(2),  le  signal  [1mSIGIO  [22mest  envoyÃ©  quand  un  Ã©vÃ©nement
       d'entrÃ©e-sortie a lieu. Il est possible d'utiliser [1mpoll[22m(2) ou [1mselect[22m(2)
       dans le gestionnaire de signal pour savoir sur quelle  socket  l'Ã©vÃ©neâ€
       ment  s'est produit. Une alternative (sous Linux 2.2) est de dÃ©finir un
       signal en temps-rÃ©el avec le  [1mfnctl[22m(2)  [1mF_SETSIG[22m.  Le  gestionnaire  du
       signal en temps-rÃ©el sera appelÃ© avec le descripteur de fichier dans le
       champ [4msi_fd[24m de [4msiginfo_t[24m. Consultez [1mfcntl[22m(2) pour plus d'informations.

       Dans certains cas (par exemple, diffÃ©rents processus accÃ©dant Ã  la mÃªme
       socket),  la  condition ayant dÃ©clenchÃ© le signal [1mSIGIO [22mpeut avoir dÃ©jÃ 
       disparu quand le processus rÃ©agit au signal. Si  cela  se  produit,  le
       processus devrait attendre Ã  nouveau car Linux renverra ce signal ultÃ©â€
       rieurement.

   [1mInterfaces /proc[0m
       Les paramÃ¨tres rÃ©seau de base des sockets sont accessibles en utilisant
       les fichiers du rÃ©pertoire [4m/proc/sys/net/core/[24m.

       [4mrmem_default[0m
              contient la taille en octets par dÃ©faut du tampon de rÃ©ception.

       [4mrmem_max[0m
              contient  la  taille  maximale  en octets du tampon de rÃ©ception
              qu'un utilisateur peut dÃ©finir avec  l'option  [1mSO_RCVBUF  [22mde  la
              socket.

       [4mwmem_default[0m
              contient  la taille en octets par dÃ©faut du tampon d'Ã©mission de
              la socket.

       [4mwmem_max[0m
              contient la taille maximale en octets du tampon d'Ã©mission qu'un
              utilisateur peut dÃ©finir avec l'option [1mSO_SNDBUF [22mde la socket.

       [4mmessage_cost[24m et [4mmessage_burst[0m
              configurent le filtrage par jeton utilisÃ© pour limiter la charge
              des messages d'avertissement dus  aux  Ã©vÃ©nements  rÃ©seau  extÃ©â€
              rieurs.

       [4mnetdev_max_backlog[0m
              contient le nombre maximal de paquets dans la file d'entrÃ©e gloâ€
              bale.

       [4moptmem_max[0m
              contient la taille maximale par socket des donnÃ©es de service et
              des donnÃ©es de contrÃ´le utilisateur comme les iovecs.

   [1mIoctls[0m
       Ces opÃ©rations sont accessibles en utilisant [1mioctl[22m(2) :

           [4merror[24m [1m= ioctl([4m[22mip_socket[24m[1m, [4m[22mtype_ioctl[24m[1m, [4m[22m&valeur_rÃ©sultat[24m[1m);[0m

       [1mSIOCGSTAMP[0m
              Renvoie  une structure [4mtimeval[24m avec la date de rÃ©ception du derâ€
              nier paquet transmis Ã  l'utilisateur. Cela est  utile  pour  des
              mesures prÃ©cises du temps de cheminement. Consultez [1msetitimer[22m(2)
              pour une description de la structure [4mtimeval[24m.  L'ioctl  ne  doit
              Ãªtre utilisÃ© que si l'option [1mSO_TIMESTAMP [22mde la socket n'est pas
              dÃ©finie. Sinon, la date du dernier paquet reÃ§u  quand  [1mSO_TIMESâ€[0m
              [1mTAMP  [22mn'Ã©tait pas dÃ©finie est renvoyÃ©e, provoquant un Ã©chec s'il
              n'existe pas de tels paquets (c'est-Ã -dire que [1mioctl[22m(2)  renvoie
              -1 avec un [4merrno[24m dÃ©fini Ã  [1mENOENT[22m).

       [1mSIOCSPGRP[0m
              DÃ©finit le processus ou le groupe de processus Ã  qui envoyer les
              signaux [1mSIGIO [22mou  [1mSIGURG  [22mlorsqu'une  opÃ©ration  d'entrÃ©e-sortie
              asynchrone  est  terminÃ©e ou si des donnÃ©es urgentes sont dispoâ€
              nibles. L'argument est un pointeur sur un [4mpid_t[24m.  Si  l'argument
              est positif, le signal est envoyÃ© Ã  ce processus. S'il est nÃ©gaâ€
              tif, le signal est envoyÃ© au groupe de processus dont  l'identiâ€
              fiant correspond Ã  la valeur absolue de l'argument. Un processus
              ne peut demander que l'Ã©mission  vers  lui-mÃªme  ou  son  propre
              groupe, Ã  moins qu'il ait la capacitÃ© [1mCAP_KILL [22mou un identifiant
              d'utilisateur effectif nul.

       [1mFIOASYNC[0m
              Change l'attribut [1mO_ASYNC [22mpour activer  ou  dÃ©sactiver  le  mode
              d'entrÃ©e-sortie asynchrone de la socket. Un mode d'entrÃ©e-sortie
              asynchrone signifie que le signal [1mSIGIO [22mou le signal dÃ©fini avec
              [1mF_SETSIG  [22mest  envoyÃ© quand un Ã©vÃ©nement d'entrÃ©e-sortie se proâ€
              duit.

              Le paramÃ¨tre est un boolÃ©en entier. (Cette opÃ©ration  est  synoâ€
              nyme  de  l'utilisation  de  [1mfcntl[22m(2)  pour  dÃ©finir  l'attribut
              [1mO_ASYNC[22m).

       [1mSIOCGPGRP[0m
              Lit le processus ou le groupe de processus  auquel  les  signaux
              [1mSIGIO  [22mou [1mSIGURG [22msont envoyÃ©s. ZÃ©ro est obtenu quand aucun n'est
              dÃ©fini.

       OpÃ©rations [1mfcntl[22m(2) valables :

       [1mFIOGETOWN[0m
              Identique Ã  l'[1mioctl[22m(2) [1mSIOCGPGRP[22m.

       [1mFIOSETOWN[0m
              Identique Ã  l'[1mioctl[22m(2) [1mSIOCSPGRP[22m.

[1mVERSIONS[0m
       [1mSO_BINDTODEVICE [22ma Ã©tÃ© introduit dans Linux 2.0.30. [1mSO_PASSCRED [22mest  une
       nouveautÃ©  de  Linux 2.2. Les interfaces [4m/proc[24m ont Ã©tÃ© introduites dans
       Linux 2.2. [1mSO_RCVTIMEO [22met [1mSO_SNDTIMEO [22msont gÃ©rÃ©s  depuis  Linux 2.3.41.
       Auparavant, les dÃ©lais d'attente Ã©taient dÃ©finis dans les protocoles et
       ne pouvaient Ãªtre ni lus ni modifiÃ©s.

[1mNOTES[0m
       Linux suppose que la moitiÃ© du tampon d'Ã©mission/rÃ©ception est  utilisÃ©
       pour  les  structures  internes  du  noyau.  Ainsi les valeurs dans les
       fichiers [4m/proc[24m correspondants sont deux fois plus grandes  que  ce  que
       l'on peut observer directement sur le cÃ¢ble.

       Linux  ne permettra la rÃ©utilisation des ports qu'avec l'option [1mSO_REUâ€[0m
       [1mSEADDR [22mlorsque celle-ci sera dÃ©finie Ã  la fois par  le  prÃ©cÃ©dent  proâ€
       gramme  qui  a  effectuÃ© un [1mbind[22m(2) sur le port et par le programme qui
       veut rÃ©utiliser ce port. Ceci diffÃ¨re de certaines implÃ©mentations (par
       exemple,  sur  FreeBSD)  oÃ¹  seul  le  dernier  programme  doit dÃ©finir
       l'option [1mSO_REUSEADDR[22m. Habituellement, cette diffÃ©rence est  invisible,
       puisque,  par  exemple,  un  programme  serveur est conÃ§u pour toujours
       dÃ©finir cette option.

[1mBOGUES[0m
       Des options [1mCONFIG_FILTER [22mde socket, [1mSO_ATTACH_FILTER [22met [1mSO_DETACH_FILâ€[0m
       [1mTER[22m,  ne  sont  pas  documentÃ©es.  Pour  les utiliser, il est conseillÃ©
       d'utiliser la bibliothÃ¨que libpcap.

[1mVOIR AUSSI[0m
       [1mconnect[22m(2), [1mgetsockopt[22m(2), [1msetsockopt[22m(2),  [1msocket[22m(2),  [1mcapabilities[22m(7),
       [1mddp[22m(7), [1mip[22m(7), [1mpacket[22m(7), [1mtcp[22m(7), [1mudp[22m(7), [1munix[22m(7)

[1mCOLOPHON[0m
       Cette  page  fait  partie  de  la  publication 3.70 du projet [4mman-pages[0m
       Linux. Une description du projet et des instructions pour signaler  des
       anomalies       peuvent       Ãªtre       trouvÃ©es      Ã       l'adresse
       http://www.kernel.org/doc/man-pages/.

[1mTRADUCTION[0m
       Depuis 2010, cette traduction est maintenue Ã  l'aide  de  l'outil  po4a
       <http://po4a.alioth.debian.org/> par l'Ã©quipe de traduction francophone
       au sein du projet perkamon <http://perkamon.alioth.debian.org/>.

       Christophe Blaess <http://www.blaess.fr/christophe/> (1996-2003), Alain
       Portal  <http://manpagesfr.free.fr/>  (2003-2006).  Julien  Cristau  et
       l'Ã©quipe francophone de traduction de Debian (2006-2009).

       Veuillez signaler toute erreur de  traduction  en  Ã©crivant  Ã   <perkaâ€
       mon-fr@traduc.org>.

       Vous  pouvez  toujours avoir accÃ¨s Ã  la version anglaise de ce document
       en utilisant la commande Â« [1mLC_ALL=C man [4m[22m<section>[24m [4m<page_de_man>[24m Â».

Linux                           8 juillet 2014                       SOCKET(7)
